{
  "filename": "client.md",
  "__html": "<h1>TxClient配置说明</h1>\n<h2>一、application.properties</h2>\n<pre><code class=\"language-properties\"><span class=\"hljs-comment\"># 事务控制切面控制次序</span>\n<span class=\"hljs-meta\">tx-lcn.client.control-order</span>=<span class=\"hljs-string\">0</span>\n<span class=\"hljs-comment\">\n# 资源切面次序</span>\n<span class=\"hljs-meta\">tx-lcn.client.resource-order</span>=<span class=\"hljs-string\">0</span>\n<span class=\"hljs-comment\">\n# manager服务地址(rpc端口),可填写多个负载</span>\n<span class=\"hljs-meta\">tx-lcn.client.manager-address</span>=<span class=\"hljs-string\">127.0.0.1:8070</span>\n<span class=\"hljs-comment\">\n# 切面日志信息(h2数据库地址)</span>\n<span class=\"hljs-meta\">tx-lcn.aspect.log.file-path</span>=<span class=\"hljs-string\">${user.dir}/.txlcn/${spring.application.name}</span>\n<span class=\"hljs-comment\">\n# 开启日志数据库记录存储</span>\n<span class=\"hljs-meta\">tx-lcn.logger.enabled</span>=<span class=\"hljs-string\">true</span>\n<span class=\"hljs-comment\">\n# 日志数据库存储jdbc配置</span>\n<span class=\"hljs-meta\">tx-lcn.logger.driver-class-name</span>=<span class=\"hljs-string\">com.mysql.jdbc.Driver</span>\n<span class=\"hljs-meta\">tx-lcn.logger.jdbc-url</span>=<span class=\"hljs-string\">jdbc:mysql://127.0.0.1:3306/tx-logger?\\\n  characterEncoding=UTF-8&amp;serverTimezone=UTC</span>\n<span class=\"hljs-meta\">tx-lcn.logger.username</span>=<span class=\"hljs-string\">root</span>\n<span class=\"hljs-meta\">tx-lcn.logger.password</span>=<span class=\"hljs-string\">123456</span>\n<span class=\"hljs-comment\">\n# 与TxManager通讯最大等待时间（秒）</span>\n<span class=\"hljs-meta\">tx-lcn.message.netty.wait-time</span>=<span class=\"hljs-string\">5</span>\n\n</code></pre>\n<h2>二、特别配置</h2>\n<h3>1、微服务<code>集群</code>且用到 <code>LCN</code> 事务模式时，为保证性能请开启 <code>TXLCN</code> 重写的负载策略。</h3>\n<ul>\n<li>Dubbo 开启</li>\n</ul>\n<pre><code class=\"language-java\"><span class=\"hljs-meta\">@Reference</span>(version = <span class=\"hljs-string\">\"${demo.service.version}\"</span>,\n        application = <span class=\"hljs-string\">\"${dubbo.application.e}\"</span>,\n        retries = -<span class=\"hljs-number\">1</span>,\n        registry = <span class=\"hljs-string\">\"${dubbo.registry.address}\"</span>,\n        loadbalance = <span class=\"hljs-string\">\"txlcn_random\"</span>)  <span class=\"hljs-comment\">// here</span>\n<span class=\"hljs-keyword\">private</span> EDemoService eDemoService;\n</code></pre>\n<ul>\n<li>SpringCloud 开启 (application.properties)</li>\n</ul>\n<pre><code class=\"language-properties\"><span class=\"hljs-meta\">tx-lcn.springcloud.loadbalance.enabled</span>=<span class=\"hljs-string\">true</span>\n</code></pre>\n<p>配置详情<a href=\"distributed.html\">参见</a></p>\n<h3>2、关闭业务RPC重试</h3>\n<ul>\n<li>Dubbo 开启</li>\n</ul>\n<pre><code class=\"language-java\"><span class=\"hljs-meta\">@Reference</span>(version = <span class=\"hljs-string\">\"${demo.service.version}\"</span>,\n        application = <span class=\"hljs-string\">\"${dubbo.application.e}\"</span>,\n        retries = -<span class=\"hljs-number\">1</span>,\n        registry = <span class=\"hljs-string\">\"${dubbo.registry.address}\"</span>,\n        loadbalance = <span class=\"hljs-string\">\"txlcn_random\"</span>)  <span class=\"hljs-comment\">// here</span>\n<span class=\"hljs-keyword\">private</span> EDemoService eDemoService;\n</code></pre>\n<ul>\n<li>SpringCloud 开启 (application.properties)</li>\n</ul>\n<pre><code class=\"language-properties\"><span class=\"hljs-comment\"># 关闭Ribbon的重试机制</span>\n<span class=\"hljs-meta\">ribbon.MaxAutoRetriesNextServer</span>=<span class=\"hljs-string\">0</span>\n</code></pre>\n<hr>\n<p><code>NOTE</code><br>\n1、TxClient所有配置均有默认配置，请按需覆盖默认配置。<br>\n2、为什么要关闭服务调用的重试。远程业务调用失败有两种可能：\n（1），远程业务执行失败 （2）、远程业务执行成功，网络失败。对于第2种，事务场景下重试会发生，某个业务执行两次的问题。\n如果业务上控制某个事务接口的幂等，则不用关闭重试。</p>\n<hr>\n",
  "link": "/en-us/docs/setting/client.html",
  "meta": {}
}